import{y as k,w as z,C as M,D as q,r,n as e}from"./components-CK9cG6NQ.js";import{t as N}from"./index-C8LQY8mX.js";import{B as n}from"./button-8oCJS-za.js";import{I as d}from"./input-BXDRLaNk.js";import{S as H,a as O,b as V,c as I,d as B}from"./select-DaRfL70x.js";import{D as K,a as L,b as U,c as G,d as J,e as Q}from"./dialog-B7fq2mTW.js";import{u as W,f as C,A as X,a as Y,b as Z,c as $,d as ee,e as se,g as ae,h as le,i as ie,j as te}from"./index-BpyxCKkI.js";import{T as ne,a as re,b as h,c as de,d as oe,e as v}from"./table-CRJQl8tI.js";import{P as ce}from"./plus-BQN0Gcjy.js";import{P as me}from"./pencil-DYF0NOrj.js";import{T as pe}from"./trash-sprkVQyV.js";import"./index-Z0unZZUp.js";import"./index-B5_uNIGj.js";import"./index-DHMePj9W.js";import"./index-USjovnYi.js";import"./index-B4BDNWcH.js";import"./createLucideIcon-B7_wo53H.js";import"./index-DPB-uZjz.js";import"./index-B4ME6Vf2.js";import"./x-DGchQd-t.js";function ze(){var b,D;const{users:he,schools:xe,classes:x,classAdmins:w}=k(),o=z(),g=M();q();const[A,c]=r.useState(!1),[i,u]=r.useState("create"),[l,j]=r.useState(null),[S,p]=r.useState(!1),[m,y]=r.useState(null);r.useEffect(()=>{o&&(o.success?(N.success(o.message),c(!1)):N.error(o.message))},[o]);const T=()=>{u("create"),j(null),c(!0)},P=s=>{u("update"),j(s),c(!0)},E=s=>{y(s),p(!0)},_=()=>{const s=new FormData;s.append("_action","delete"),s.append("id",m.id),g(s,{method:"post"}),p(!1)},F=s=>{s.preventDefault();const a=new FormData(s.currentTarget);a.append("_action",i),i==="update"&&l&&a.append("id",l.id),g(a,{method:"post"})},f=[{accessorKey:"admin_name",header:"Admin Name",cell:({row:s})=>e.jsx("div",{className:"text-center flex items-center justify-center gap-2",children:s.original.admin_name})},{accessorKey:"admin_email",header:"Email",cell:({row:s})=>e.jsx("div",{className:"text-center",children:s.original.admin_email})},{accessorKey:"class_name",header:"Class",cell:({row:s})=>e.jsx("div",{className:"text-center",children:s.original.class_name})},{id:"actions",header:"Actions",cell:({row:s})=>e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>P(s.original),children:e.jsx(me,{className:"size-4"})}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>E(s.original),children:e.jsx(pe,{className:"size-4"})})]})}],t=W({data:w,columns:f,getCoreRowModel:te(),getPaginationRowModel:ie(),initialState:{pagination:{pageSize:10}}}),R=i==="create"?"Create New Class Admin":"Edit Assignment";return e.jsxs("div",{className:"container mx-auto pb-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("span",{className:"ml-2 pt-2 text-xl font-semibold",children:"Manage Class Admins"}),e.jsxs(n,{onClick:T,children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Add Class Admin"})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(ne,{children:[e.jsx(re,{children:t.getHeaderGroups().map(s=>e.jsx(h,{children:s.headers.map(a=>e.jsx(de,{className:"text-center",children:a.isPlaceholder?null:C(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(oe,{children:t.getRowModel().rows.length?t.getRowModel().rows.map(s=>e.jsx(h,{"data-state":s.getIsSelected()&&"selected",children:s.getVisibleCells().map(a=>e.jsx(v,{className:"text-center",children:C(a.column.columnDef.cell,a.getContext())},a.id))},s.id)):e.jsx(h,{children:e.jsx(v,{colSpan:f.length,className:"h-24 text-center",children:"No assignments found."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>t.previousPage(),disabled:!t.getCanPreviousPage(),children:"Previous"}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>t.nextPage(),disabled:!t.getCanNextPage(),children:"Next"})]}),e.jsx(K,{open:A,onOpenChange:c,children:e.jsxs(L,{children:[e.jsxs(U,{children:[e.jsx(G,{children:R}),e.jsx(J,{children:i==="create"?"Enter admin details and assign to school and class.":"Update the class admin assignment."})]}),e.jsxs("form",{onSubmit:F,children:[e.jsxs("div",{className:"grid gap-4 pb-4",children:[i==="create"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"name",children:"Admin Name"}),e.jsx(d,{id:"name",name:"name",placeholder:"Enter name",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx(d,{id:"email",name:"email",type:"email",placeholder:"Enter email",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx(d,{id:"password",name:"password",type:"password",placeholder:"Enter password",required:!0})]})]}),i==="update"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"name",children:"Admin Name"}),e.jsx(d,{id:"name",name:"name",placeholder:"Enter name",defaultValue:(l==null?void 0:l.admin_name)||"",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx(d,{id:"email",name:"email",type:"email",placeholder:"Enter email",defaultValue:(l==null?void 0:l.admin_email)||"",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx(d,{id:"password",name:"password",type:"password",placeholder:"Leave blank to keep current password"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"class_id",children:"Class"}),e.jsxs(H,{name:"class_id",defaultValue:((b=l==null?void 0:l.class_id)==null?void 0:b.toString())||((D=x[0])==null?void 0:D.id.toString()),required:!0,children:[e.jsx(O,{className:"w-full",children:e.jsx(V,{placeholder:"Select a class"})}),e.jsx(I,{children:x.map(s=>e.jsx(B,{value:s.id.toString(),children:s.name},s.id))})]})]})]}),e.jsxs(Q,{children:[e.jsx(n,{variant:"outline",onClick:()=>c(!1),type:"button",children:"Cancel"}),e.jsx(n,{type:"submit",children:i==="create"?"Create & Assign":"Update Assignment"})]})]})]})}),e.jsx(X,{open:S,onOpenChange:p,children:e.jsxs(Y,{children:[e.jsxs(Z,{className:"text-center",children:[e.jsx($,{children:"Delete Assignment"}),e.jsxs(ee,{children:['Are you sure you want to delete the assignment for "',m==null?void 0:m.admin_name,'"? This action cannot be undone.']})]}),e.jsxs(se,{className:"flex justify-end",children:[e.jsx(ae,{children:"Cancel"}),e.jsx(le,{onClick:_,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})})]})}export{ze as default};
