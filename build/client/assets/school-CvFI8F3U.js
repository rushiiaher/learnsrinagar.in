import{y as k,w as z,C as E,D as M,r as i,n as e}from"./components-CK9cG6NQ.js";import{t as S}from"./index-C8LQY8mX.js";import{B as o}from"./button-8oCJS-za.js";import{I as H}from"./input-BXDRLaNk.js";import{T as O}from"./textarea-Bw-iKE1d.js";import{D as I,a as K,b as U,c as B,d as L,e as q}from"./dialog-B7fq2mTW.js";import{S as G,a as J,b as Q,c as W,d as X}from"./select-DaRfL70x.js";import{u as Y,f as C,A as Z,a as $,b as ee,c as ae,d as se,e as te,g as le,h as oe,i as ie,j as ne}from"./index-BpyxCKkI.js";import{T as re,a as ce,b as h,c as de,d as me,e as N}from"./table-CRJQl8tI.js";import{P as he}from"./plus-BQN0Gcjy.js";import{P as ue}from"./pencil-DYF0NOrj.js";import{T as pe}from"./trash-sprkVQyV.js";import"./index-DPB-uZjz.js";import"./index-Z0unZZUp.js";import"./index-B5_uNIGj.js";import"./index-B4ME6Vf2.js";import"./x-DGchQd-t.js";import"./createLucideIcon-B7_wo53H.js";import"./index-DHMePj9W.js";import"./index-USjovnYi.js";import"./index-B4BDNWcH.js";function Ee(){var f,D,b;const{schools:v,users:u}=k(),n=z(),p=E();M();const[T,r]=i.useState(!1),[c,x]=i.useState("create"),[t,g]=i.useState(null),[A,m]=i.useState(!1),[d,w]=i.useState(null);i.useEffect(()=>{n&&(n.success?(S.success(n.message),r(!1)):S.error(n.message))},[n]);const y=()=>{x("create"),g(null),r(!0)},P=a=>{x("update"),g(a),r(!0)},R=a=>{w(a),m(!0)},V=()=>{const a=new FormData;a.append("_action","delete"),a.append("id",d.id),p(a,{method:"post"}),m(!1)},_=a=>{a.preventDefault();const s=new FormData(a.currentTarget);s.append("_action",c),c==="update"&&t&&s.append("id",t.id),p(s,{method:"post"})},j=[{accessorKey:"name",header:"School Name",cell:({row:a})=>a.getValue("name")},{accessorKey:"address",header:"Address",cell:({row:a})=>a.getValue("address")},{accessorKey:"user_name",header:"Associated User",cell:({row:a})=>a.getValue("user_name")},{accessorKey:"created_at",header:"Created At",cell:({row:a})=>new Date(a.getValue("created_at")).toLocaleDateString()},{id:"actions",header:"Actions",cell:({row:a})=>e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>P(a.original),children:e.jsx(ue,{className:"size-4"})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>R(a.original),children:e.jsx(pe,{className:"size-4"})})]})}],l=Y({data:v,columns:j,getCoreRowModel:ne(),getPaginationRowModel:ie(),initialState:{pagination:{pageSize:10}}}),F=c==="create"?"Create New School":"Edit School";return e.jsxs("div",{className:"container mx-auto pb-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("span",{className:"ml-2 pt-2 text-xl font-semibold",children:"Manage Schools"}),e.jsxs(o,{onClick:y,children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Add School"})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(re,{children:[e.jsx(ce,{children:l.getHeaderGroups().map(a=>e.jsx(h,{children:a.headers.map(s=>e.jsx(de,{className:"text-center",children:s.isPlaceholder?null:C(s.column.columnDef.header,s.getContext())},s.id))},a.id))}),e.jsx(me,{children:(f=l.getRowModel().rows)!=null&&f.length?l.getRowModel().rows.map(a=>e.jsx(h,{"data-state":a.getIsSelected()&&"selected",children:a.getVisibleCells().map(s=>e.jsx(N,{className:"text-center",children:C(s.column.columnDef.cell,s.getContext())},s.id))},a.id)):e.jsx(h,{children:e.jsx(N,{colSpan:j.length,className:"h-24 text-center",children:"No schools found."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>l.previousPage(),disabled:!l.getCanPreviousPage(),children:"Previous"}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>l.nextPage(),disabled:!l.getCanNextPage(),children:"Next"})]}),e.jsx(I,{open:T,onOpenChange:r,children:e.jsxs(K,{children:[e.jsxs(U,{children:[e.jsx(B,{children:F}),e.jsx(L,{children:c==="create"?"Fill out the form below to create a new school.":"Update the school information."})]}),e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{className:"grid gap-4 pb-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"name",children:"School Name"}),e.jsx(H,{id:"name",name:"name",placeholder:"Enter school name",defaultValue:(t==null?void 0:t.name)||"",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"address",children:"Address"}),e.jsx(O,{id:"address",name:"address",placeholder:"Enter school address",defaultValue:(t==null?void 0:t.address)||"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"users_id",children:"Associated User"}),e.jsxs(G,{name:"users_id",defaultValue:((D=t==null?void 0:t.users_id)==null?void 0:D.toString())||((b=u[0])==null?void 0:b.id.toString()),children:[e.jsx(J,{className:"w-full",children:e.jsx(Q,{placeholder:"Select a user"})}),e.jsx(W,{children:u.map(a=>e.jsx(X,{value:a.id.toString(),children:a.name},a.id))})]})]})]}),e.jsxs(q,{children:[e.jsx(o,{variant:"outline",onClick:()=>r(!1),type:"button",children:"Cancel"}),e.jsx(o,{type:"submit",children:c==="create"?"Create School":"Update School"})]})]})]})}),e.jsx(Z,{open:A,onOpenChange:m,children:e.jsxs($,{children:[e.jsxs(ee,{className:"text-center",children:[e.jsx(ae,{children:"Delete School"}),e.jsxs(se,{children:['Are you sure you want to delete school "',d==null?void 0:d.name,'"? This action cannot be undone.']})]}),e.jsxs(te,{className:"flex justify-end",children:[e.jsx(le,{children:"Cancel"}),e.jsx(oe,{onClick:V,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})})]})}export{Ee as default};
