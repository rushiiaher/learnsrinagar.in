import{y as J,w as Q,C as W,D as X,r as i,n as e}from"./components-CK9cG6NQ.js";import{t as y}from"./index-C8LQY8mX.js";import{B as r}from"./button-8oCJS-za.js";import{I as m}from"./input-BXDRLaNk.js";import{T as S}from"./textarea-Bw-iKE1d.js";import{S as Y,a as Z,b as V,c as ee,d as se}from"./select-DaRfL70x.js";import{D as _,a as w,b as A,c as H,d as te,e as ae}from"./dialog-B7fq2mTW.js";import{u as le,f as T,A as ie,a as re,b as ne,c as ce,d as oe,e as de,g as me,h as xe,i as he,j as ue}from"./index-BpyxCKkI.js";import{T as pe,a as je,b as g,c as ge,d as fe,e as k}from"./table-CRJQl8tI.js";import{L as x}from"./label-DqiQ_QAn.js";import{P as be}from"./plus-BQN0Gcjy.js";import{B as De}from"./book-open-BKBxQZok.js";import{E as Ne}from"./eye--hK9STUc.js";import{P as ve}from"./pencil-DYF0NOrj.js";import{T as Ce}from"./trash-sprkVQyV.js";import"./index-Z0unZZUp.js";import"./index-B5_uNIGj.js";import"./index-DHMePj9W.js";import"./index-USjovnYi.js";import"./index-B4BDNWcH.js";import"./createLucideIcon-B7_wo53H.js";import"./index-DPB-uZjz.js";import"./index-B4ME6Vf2.js";import"./x-DGchQd-t.js";function Qe(){var C;const{homework:F,subjects:O,user:u}=J(),c=Q(),f=W();X();const[P,o]=i.useState(!1),[d,b]=i.useState("create"),[l,D]=i.useState(null),[R,p]=i.useState(!1),[h,z]=i.useState(null),[E,N]=i.useState(!1),[t,M]=i.useState(null);i.useEffect(()=>{c&&(c.success?y.success(c.message):y.error(c.message),c.success&&(o(!1),p(!1)))},[c]);const B=()=>{b("create"),D(null),o(!0)},L=s=>{b("update"),D(s),o(!0)},K=s=>{M(s),N(!0)},q=s=>{z(s),p(!0)},I=()=>{const s=new FormData;s.append("_action","delete"),s.append("id",h.id),f(s,{method:"post"})},U=s=>{s.preventDefault();const a=new FormData(s.currentTarget);a.append("_action",d),d==="update"&&l&&a.append("id",l.id),f(a,{method:"post"})},$=s=>u.role_name==="teacher"&&s.teacher_id===u.id,j=u.role_name==="teacher",v=[{accessorKey:"title",header:"Title",cell:({row:s})=>e.jsx("div",{className:"text-center",children:s.original.title})},{accessorKey:"subject_name",header:"Subject",cell:({row:s})=>e.jsxs("div",{className:"text-center",children:[s.original.subject_name," (",s.original.class_name,")"]})},{accessorKey:"teacher_name",header:"Teacher",cell:({row:s})=>e.jsx("div",{className:"text-center",children:s.original.teacher_name})},{accessorKey:"created_at",header:"Created At",cell:({row:s})=>e.jsx("div",{className:"text-center",children:new Date(s.original.created_at).toLocaleDateString()})},{id:"actions",header:"Actions",cell:({row:s})=>e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>K(s.original),children:e.jsx(Ne,{className:"size-4"})}),$(s.original)&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>L(s.original),children:e.jsx(ve,{className:"size-4"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>q(s.original),children:e.jsx(Ce,{className:"size-4"})})]})]})}],n=le({data:F,columns:v,getCoreRowModel:ue(),getPaginationRowModel:he(),initialState:{pagination:{pageSize:10}}}),G=d==="create"?"Create New Homework":"Edit Homework";return e.jsxs("div",{className:"container mx-auto pb-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("span",{className:"ml-2 pt-2 text-xl font-semibold",children:"Manage Homework"}),j&&e.jsxs(r,{onClick:B,children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Add Homework"})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(pe,{children:[e.jsx(je,{children:n.getHeaderGroups().map(s=>e.jsx(g,{children:s.headers.map(a=>e.jsx(ge,{className:"text-center",children:a.isPlaceholder?null:T(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(fe,{children:n.getRowModel().rows.length?n.getRowModel().rows.map(s=>e.jsx(g,{children:s.getVisibleCells().map(a=>e.jsx(k,{className:"text-center",children:T(a.column.columnDef.cell,a.getContext())},a.id))},s.id)):e.jsx(g,{children:e.jsx(k,{colSpan:v.length,className:"h-24 text-center",children:"No homework assignments found."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>n.previousPage(),disabled:!n.getCanPreviousPage(),children:"Previous"}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>n.nextPage(),disabled:!n.getCanNextPage(),children:"Next"})]}),j&&e.jsx(_,{open:P,onOpenChange:o,children:e.jsxs(w,{className:"max-w-2xl",children:[e.jsxs(A,{children:[e.jsx(H,{children:G}),e.jsx(te,{children:d==="create"?"Fill out the form below to create a new homework assignment.":"Update the homework information."})]}),e.jsxs("form",{onSubmit:U,children:[e.jsxs("div",{className:"grid gap-6 pb-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"title",children:"Title"}),e.jsx(m,{id:"title",name:"title",placeholder:"Enter homework title",defaultValue:(l==null?void 0:l.title)||"",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"subject_id",children:"Subject"}),e.jsxs(Y,{name:"subject_id",defaultValue:((C=l==null?void 0:l.subject_id)==null?void 0:C.toString())||"",required:!0,children:[e.jsx(Z,{className:"w-full",children:e.jsx(V,{placeholder:"Select a subject"})}),e.jsx(ee,{children:O.map(s=>e.jsxs(se,{value:s.id.toString(),children:[s.name," (Class ",s.class_name,")"]},s.id))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"description",children:"Description"}),e.jsx(S,{id:"description",name:"description",placeholder:"Enter homework description",rows:5,defaultValue:(l==null?void 0:l.description)||"",required:!0})]})]}),e.jsxs(ae,{children:[e.jsx(r,{variant:"outline",onClick:()=>o(!1),type:"button",children:"Cancel"}),e.jsx(r,{type:"submit",children:d==="create"?"Create Homework":"Update Homework"})]})]})]})}),j&&e.jsx(ie,{open:R,onOpenChange:p,children:e.jsxs(re,{children:[e.jsxs(ne,{className:"text-center",children:[e.jsx(ce,{children:"Delete Homework"}),e.jsxs(oe,{children:['Are you sure you want to delete the homework "',h==null?void 0:h.title,'"? This action cannot be undone.']})]}),e.jsxs(de,{className:"flex justify-end",children:[e.jsx(me,{children:"Cancel"}),e.jsx(xe,{onClick:I,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsx(_,{open:E,onOpenChange:N,children:e.jsxs(w,{className:"max-w-3xl",children:[e.jsx(A,{children:e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5"}),e.jsx("span",{children:"Homework Details"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"title",className:"text-sm font-medium",children:"Title"}),e.jsx(m,{type:"text",id:"title",value:t==null?void 0:t.title,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"subject",className:"text-sm font-medium",children:"Subject"}),e.jsx(m,{type:"text",id:"subject",value:`${t==null?void 0:t.subject_name} (${t==null?void 0:t.class_name})`,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"teacher",className:"text-sm font-medium",children:"Teacher"}),e.jsx(m,{type:"text",id:"teacher",value:t==null?void 0:t.teacher_name,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"created_at",className:"text-sm font-medium",children:"Created At"}),e.jsx(m,{type:"text",id:"created_at",value:new Date(t==null?void 0:t.created_at).toLocaleString(),readOnly:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(x,{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),e.jsx(S,{id:"description",value:t==null?void 0:t.description,readOnly:!0,rows:5})]})]})]})})]})}export{Qe as default};
