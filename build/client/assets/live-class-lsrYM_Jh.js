import{y as W,w as X,x as Z,r as u,n as e,F as E}from"./components-CK9cG6NQ.js";import{t as K}from"./index-C8LQY8mX.js";import{C as ee,a as se,b as ae,c as le,d as ie}from"./card-CA1SrpzI.js";import{I as j}from"./input-BXDRLaNk.js";import{L as r}from"./label-DqiQ_QAn.js";import{B as p}from"./button-8oCJS-za.js";import{D as te,f as re,a as ce,b as ne,c as de,d as oe}from"./dialog-B7fq2mTW.js";import{S as n,a as d,b as o,c as h,d as l}from"./select-DaRfL70x.js";import{T as he,a as ue,b as w,c as me,d as xe,e as O}from"./table-CRJQl8tI.js";import{u as je,f as R,A as pe,k as ge,a as ve,b as Se,c as _e,d as fe,e as be,g as ye,h as Ce,j as Ne}from"./index-BpyxCKkI.js";import{B as H}from"./badge-CcGIdf3j.js";import{P as Te}from"./plus-BQN0Gcjy.js";import{S as we,a as De,T as Le,E as Ae}from"./trash-2-DbvqRWWT.js";import{C as I,a as ke}from"./clock-XivtrA7v.js";import{P as Fe}from"./play-CXAmcsiu.js";import"./index-B5_uNIGj.js";import"./index-DPB-uZjz.js";import"./index-Z0unZZUp.js";import"./index-B4ME6Vf2.js";import"./x-DGchQd-t.js";import"./createLucideIcon-B7_wo53H.js";import"./index-DHMePj9W.js";import"./index-USjovnYi.js";import"./index-B4BDNWcH.js";const qe=S=>{const _={scheduled:{color:"bg-blue-100 text-blue-800",icon:I,text:"Scheduled"},live:{color:"bg-red-100 text-red-800",icon:Fe,text:"Live Now"},completed:{color:"bg-green-100 text-green-800",icon:ke,text:"Completed"},cancelled:{color:"bg-gray-100 text-gray-800",icon:I,text:"Cancelled"}},m=_[S]||_.scheduled,y=m.icon;return e.jsxs(H,{className:`${m.color} flex items-center gap-1`,children:[e.jsx(y,{className:"h-3 w-3"}),m.text]})};function ts(){var F;const{classes:S,subjects:_,teachers:m,liveClasses:y,schools:M,user:f}=W(),c=X(),D=Z().state==="submitting",[P,g]=u.useState(!1),[v,L]=u.useState("create"),[a,C]=u.useState(null),[x,Y]=u.useState(null),[A,N]=u.useState("subject_specific"),[t,b]=u.useState({search:"",status:"all",teacher:"all",class:"all"});u.useEffect(()=>{c!=null&&c.success?(K.success(c.message),g(!1),C(null)):(c==null?void 0:c.success)===!1&&K.error(c.message)},[c]);const z=()=>{L("create"),C(null),N("subject_specific"),g(!0)},G=s=>{L("update"),C(s),N(s.session_type),g(!0)},k=[{accessorKey:"title",header:"Title",cell:({row:s})=>e.jsx("div",{className:"text-center font-medium",children:s.original.title})},{accessorKey:"session_type",header:"Type",cell:({row:s})=>e.jsx("div",{className:"text-center",children:e.jsx(H,{variant:s.original.session_type==="subject_specific"?"default":"secondary",children:s.original.session_type==="subject_specific"?"Subject":"Other Topic"})})},{accessorKey:"topic_name",header:"Topic",cell:({row:s})=>e.jsx("div",{className:"text-center",children:s.original.topic_name})},{accessorKey:"subject_name",header:"Subject",cell:({row:s})=>e.jsx("div",{className:"text-center",children:s.original.subject_name||"N/A"})},{accessorKey:"class_name",header:"Class",cell:({row:s})=>e.jsx("div",{className:"text-center",children:s.original.class_name})},{accessorKey:"teacher_name",header:"Teacher",cell:({row:s})=>e.jsx("div",{className:"text-center",children:s.original.teacher_name})},{accessorKey:"start_time",header:"Start Time",cell:({row:s})=>e.jsx("div",{className:"text-center",children:s.original.start_time?new Date(s.original.start_time).toLocaleString():"Not scheduled"})},{accessorKey:"status",header:"Status",cell:({row:s})=>e.jsx("div",{className:"text-center",children:qe(s.original.status)})},{id:"actions",header:"Actions",cell:({row:s})=>e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>G(s.original),children:e.jsx(De,{className:"h-4 w-4"})}),e.jsxs(pe,{children:[e.jsx(ge,{asChild:!0,children:e.jsx(p,{variant:"outline",size:"sm",onClick:()=>Y(s.original),children:e.jsx(Le,{className:"h-4 w-4"})})}),e.jsxs(ve,{children:[e.jsxs(Se,{children:[e.jsx(_e,{children:"Delete Live Class"}),e.jsxs(fe,{children:['Are you sure you want to delete "',x==null?void 0:x.title,'"? This action cannot be undone.']})]}),e.jsxs(be,{children:[e.jsx(ye,{children:"Cancel"}),e.jsxs(E,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"delete"}),e.jsx("input",{type:"hidden",name:"id",value:x==null?void 0:x.id}),e.jsx(Ce,{type:"submit",children:"Delete"})]})]})]})]}),e.jsx(p,{variant:"outline",size:"sm",onClick:()=>window.open(s.original.youtube_live_link,"_blank"),title:"Open YouTube Live",children:e.jsx(Ae,{className:"h-4 w-4"})})]})}],U=y.filter(s=>{var q,V,B;const i=!t.search||s.title.toLowerCase().includes(t.search.toLowerCase())||((q=s.topic_name)==null?void 0:q.toLowerCase().includes(t.search.toLowerCase())),$=t.status==="all"||s.status===t.status,J=t.teacher==="all"||((V=s.teacher_id)==null?void 0:V.toString())===t.teacher,Q=t.class==="all"||((B=s.class_id)==null?void 0:B.toString())===t.class;return i&&$&&J&&Q}),T=je({data:U,columns:k,getCoreRowModel:Ne()});return e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs(ee,{children:[e.jsxs(se,{children:[e.jsxs("div",{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ae,{className:"text-2xl font-bold",children:"Live Classes"}),e.jsx(le,{children:"Manage YouTube Live lecture sessions for students"})]}),e.jsxs(p,{onClick:z,children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add Live Session"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(j,{placeholder:"Search classes...",value:t.search,onChange:s=>b(i=>({...i,search:s.target.value})),className:"pl-8"})]}),e.jsxs(n,{value:t.status,onValueChange:s=>b(i=>({...i,status:s})),children:[e.jsx(d,{children:e.jsx(o,{placeholder:"Status"})}),e.jsxs(h,{children:[e.jsx(l,{value:"all",children:"All Status"}),e.jsx(l,{value:"scheduled",children:"Scheduled"}),e.jsx(l,{value:"live",children:"Live"}),e.jsx(l,{value:"completed",children:"Completed"})]})]}),e.jsxs(n,{value:t.teacher,onValueChange:s=>b(i=>({...i,teacher:s})),children:[e.jsx(d,{children:e.jsx(o,{placeholder:"Teacher"})}),e.jsxs(h,{children:[e.jsx(l,{value:"all",children:"All Teachers"}),m.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs(n,{value:t.class,onValueChange:s=>b(i=>({...i,class:s})),children:[e.jsx(d,{children:e.jsx(o,{placeholder:"Class"})}),e.jsxs(h,{children:[e.jsx(l,{value:"all",children:"All Classes"}),S.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))]})]})]})]}),e.jsxs(te,{open:P,onOpenChange:g,children:[e.jsx(re,{asChild:!0,children:e.jsx("div",{style:{display:"none"}})}),e.jsxs(ce,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ne,{children:[e.jsx(de,{children:v==="create"?"Create New Live Session":"Edit Live Session"}),e.jsx(oe,{children:v==="create"?"Add a new YouTube Live lecture session for students.":"Update the live session information."})]}),e.jsxs(E,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:v==="create"?"create":"update"}),v==="update"&&e.jsx("input",{type:"hidden",name:"id",value:a==null?void 0:a.id}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"title",children:"Session Title *"}),e.jsx(j,{id:"title",name:"title",placeholder:"e.g., Mathematics Live Session",required:!0,defaultValue:(a==null?void 0:a.title)||""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"youtube_live_link",children:"YouTube Live Link *"}),e.jsx(j,{id:"youtube_live_link",name:"youtube_live_link",type:"url",placeholder:"https://www.youtube.com/watch?v=...",required:!0,defaultValue:(a==null?void 0:a.youtube_live_link)||""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"session_type",children:"Session Type *"}),e.jsxs(n,{name:"session_type",value:A,onValueChange:N,required:!0,children:[e.jsx(d,{children:e.jsx(o,{placeholder:"Select session type"})}),e.jsxs(h,{children:[e.jsx(l,{value:"subject_specific",children:"Subject-Specific Session"}),e.jsx(l,{value:"other_topic",children:"Other Topic Session"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"topic_name",children:"Topic Name *"}),e.jsx(j,{id:"topic_name",name:"topic_name",placeholder:"e.g., Algebra Basics, Career Guidance",required:!0,defaultValue:(a==null?void 0:a.topic_name)||""})]}),A==="subject_specific"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"subject_id",children:"Subject"}),e.jsxs(n,{name:"subject_id",children:[e.jsx(d,{children:e.jsx(o,{placeholder:"Select subject"})}),e.jsx(h,{children:_.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"class_id",children:"Class *"}),e.jsxs(n,{name:"class_id",required:!0,children:[e.jsx(d,{children:e.jsx(o,{placeholder:"Select class"})}),e.jsx(h,{children:S.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))})]})]}),f.role_name!=="teacher"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"teacher_id",children:"Teacher *"}),e.jsxs(n,{name:"teacher_id",required:!0,children:[e.jsx(d,{children:e.jsx(o,{placeholder:"Select teacher"})}),e.jsx(h,{children:m.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))})]})]}),(f.role_name==="super_admin"||f.role_name==="school_admin")&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"school_id",children:"School *"}),e.jsxs(n,{name:"school_id",required:!0,children:[e.jsx(d,{children:e.jsx(o,{placeholder:"Select school"})}),e.jsxs(h,{children:[f.role_name==="super_admin"&&e.jsx(l,{value:"all",children:"All Schools"}),M.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"start_time",children:"Start Time *"}),e.jsx(j,{id:"start_time",name:"start_time",type:"datetime-local",required:!0,defaultValue:a!=null&&a.start_time?new Date(a.start_time).toISOString().slice(0,16):""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"end_time",children:"End Time *"}),e.jsx(j,{id:"end_time",name:"end_time",type:"datetime-local",required:!0,defaultValue:a!=null&&a.end_time?new Date(a.end_time).toISOString().slice(0,16):""})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"status",children:"Status *"}),e.jsxs(n,{name:"status",required:!0,children:[e.jsx(d,{children:e.jsx(o,{placeholder:"Select status"})}),e.jsxs(h,{children:[e.jsx(l,{value:"scheduled",children:"Scheduled"}),e.jsx(l,{value:"live",children:"Live Now"}),e.jsx(l,{value:"completed",children:"Completed"}),e.jsx(l,{value:"cancelled",children:"Cancelled"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(p,{type:"submit",disabled:D,children:D?"Saving...":v==="create"?"Create Session":"Update Session"})]})]})]})]}),e.jsx(ie,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(he,{children:[e.jsx(ue,{children:T.getHeaderGroups().map(s=>e.jsx(w,{children:s.headers.map(i=>e.jsx(me,{className:"text-center",children:i.isPlaceholder?null:R(i.column.columnDef.header,i.getContext())},i.id))},s.id))}),e.jsx(xe,{children:(F=T.getRowModel().rows)!=null&&F.length?T.getRowModel().rows.map(s=>e.jsx(w,{"data-state":s.getIsSelected()&&"selected",children:s.getVisibleCells().map(i=>e.jsx(O,{className:"text-center",children:R(i.column.columnDef.cell,i.getContext())},i.id))},s.id)):e.jsx(w,{children:e.jsx(O,{colSpan:k.length,className:"h-24 text-center",children:"No live sessions found."})})})]})})})]})})}export{ts as default};
